(()=>{class e{dropdown=null;button=null;select=null;menu=null;settings={multiple:!1,size:null,title:"Select",dropdownTick:!0,selectedMax:null,selectedText:"{0} selected",menuHeight:0,menuItemHeight:null,searchShow:!1,searchInputPlaceHolder:"Filter...",searchFrom:null,searchNoResultsText:'No results matched "{0}"',clearButtonShow:!1,clearButtonText:"clear selection"};selectedCount=1;selectedItems=[];originals=[];values=[];texts=[];searchString="";constructor(e){if(this.select=e,this.settings.multiple=e.multiple,this.settings.size=(e.size||void 0)??(parseInt(this.settings.size)?10:null),e.title&&(this.settings.title=e.title),Object.entries(e.dataset).forEach((([e,t])=>{switch(e){case"tick":this.settings.dropdownTick="false"!==t.toLowerCase();break;case"search":this.settings.searchShow="true"===t.toLowerCase();break;case"searchPlaceholder":this.settings.searchInputPlaceHolder=t;break;case"searchFrom":"values"==t?this.settings.searchFrom="values":"both"==t&&(this.settings.searchFrom="both");break;case"searchNoResults":this.settings.searchNoResultsText=t;break;case"selectedCount":this.selectedCount=parseInt(t);break;case"selectedText":this.settings.selectedText=t;break;case"selectedMax":this.selectedMax=parseInt(t);break;case"clearShow":this.settings.clearButtonShow="true"===t;break;case"clearText":this.settings.clearButtonText=t;break;case"menuItemHeight":this.settings.menuItemHeight=parseInt(t)}})),e.options.length)for(let t=0;t<e.options.length;t++)this.originals[t]=e.options[t].text,this.values[t]=e.options[t].value.toLowerCase(),this.texts[t]=e.options[t].text.toLowerCase();this.render()}selectMenuItem(e,t){let s=this;if("keydown"===t.type){if("Space"!==t.code)return;t.preventDefault()}let n=parseInt(s.dataset.pos);if(!e.settings.multiple){let t=e.select.querySelectorAll("option"),n=Array.from(s.parentNode.children);e.selectedItems.forEach((function(e){t[e].selected=null,n[e].classList.remove("selected")})),e.selectedItems=[]}if(s.classList.contains("selected")){if(s.classList.remove("selected"),e.select.options[n].selected="",e.selectedItems.length){let t=e.selectedItems.indexOf(n);e.selectedItems.splice(t,1)}}else{let t=e.settings.selectedMax;if(null!==t&&e.selectedItems.length==t)return;s.classList.add("selected"),e.select.options[n].selected="selected",e.selectedItems.push(n)}e.changeDropdownButton(),e.settings.multiple||e.dropdown.classList.remove("open-menu")}addHandlerSelect(e,t){t.addEventListener("keydown",this.selectMenuItem.bind(t,e)),t.addEventListener("click",this.selectMenuItem.bind(t,e))}createDropdownButton(e,t){let s=document.createElement("button");s.type="button",s.classList.add("ezmodus-dropdown"),s.addEventListener("click",(function(){e.classList.toggle("open-menu")})),t.classList.forEach((function(e){"ezmodus-select-picker"!==e&&s.classList.add(e)}));let n=document.createElement("span");if(n.classList.add("text"),n.innerText=this.title,s.appendChild(n),this.settings.dropdownTick){let e=document.createElement("i");e.classList.add("tick"),s.appendChild(e)}return s}createClearButton(){let e=this,t=document.createElement("div");t.classList.add("ezmodus-clear");let s=document.createElement("button");return s.type="button",s.name="clear",s.innerHTML=e.settings.clearButtonText,s.addEventListener("click",(function(t){if(e.selectedItems.length){let t=e.select.querySelectorAll("option"),n=s.closest(".ezmodus-menu").querySelectorAll("li");e.selectedItems.forEach((function(e){t[e].selected=null,n[e].classList.remove("selected")})),e.selectedItems=[]}e.changeDropdownButton()})),t.appendChild(s),t}createMenuItem(e,t,s){let n=document.createElement("li");n.tabIndex=0,n.dataset.pos=t,s.selected&&(n.classList.add("selected"),e.selectedItems.push(t)),s.disabled?n.dataset.disabled="true":this.addHandlerSelect(e,n),s.classList.forEach((function(e){n.classList.add(e)}));let l=document.createElement("i");l.classList.add("checkmark");let i=document.createElement("span");i.classList.add("text"),i.innerHTML=s.text;let c=document.createElement("a"),a=document.createElement("div");if(a.classList.add("item-wrapper"),a.appendChild(l),a.appendChild(i),c.appendChild(a),s.dataset.desc){let e=document.createElement("div");e.classList.add("subtext"),e.innerHTML=s.dataset.desc,c.appendChild(e)}return n.appendChild(c),n}addHandlerSearch(e,t,s){let n="";this.value&&(n=this.value.toLowerCase());let l=[];"both"==e.settings.searchFrom?(e.values.forEach((function(e,t){-1!==e.indexOf(n)&&l.push(t)})),e.texts.forEach((function(e,t){-1===e.indexOf(n)||l.includes(t)||l.push(t)}))):"values"==e.settings.searchFrom?e.values.forEach((function(e,t){-1!==e.indexOf(n)&&l.push(t)})):e.texts.forEach((function(e,t){-1!==e.indexOf(n)&&l.push(t)})),t.querySelectorAll("li").forEach((function(e){l.includes(parseInt(e.dataset.pos))?e.style.display="list-item":e.style.display="none"}));let i=t.querySelector("div.no-results");if(l.length)i.innerHTML="",i.style.display="none";else{let t=e.settings.searchNoResultsText.replace("{0}",n);i.innerHTML=t,i.style.display="block"}e.searchString=n}createMenu(){let e=this,t=this.select,s=document.createElement("div");if(s.classList.add("ezmodus-menu"),s.tabIndex=-1,e.settings.searchShow){let t=document.createElement("div");t.classList.add("ezmodus-search");let n=document.createElement("input");n.type="search",n.autocomplete="off",n.placeholder=e.settings.searchInputPlaceHolder,n.addEventListener("keyup",this.addHandlerSearch.bind(n,e,s)),n.addEventListener("change",this.addHandlerSearch.bind(n,e,s)),t.appendChild(n),s.appendChild(t),s.classList.add("with-search")}if(e.settings.multiple&&e.settings.clearButtonShow){let e=this.createClearButton();s.appendChild(e)}let n=document.createElement("ul");if(t.options.length)for(let s=0;s<t.options.length;s++){let l=this.createMenuItem(e,s,t.options[s]);n.appendChild(l)}s.appendChild(n);let l=document.createElement("div");return l.classList.add("no-results"),s.appendChild(l),this.menu=s,s}changeDropdownButton(){let e=this;if(!e.selectedItems.length)return e.button.querySelector("span").innerHTML=e.settings.title,void(e.button.querySelector("span").innerText=e.settings.title);if(e.selectedCount>e.selectedItems.length-1){let t=[];e.selectedItems.forEach((function(s){t.push(e.originals[s])}));let s=t.join(", ");return e.button.querySelector("span").innerHTML=s,void(e.button.querySelector("span").innerText=s)}let t=e.settings.selectedText.replace("{0}",e.selectedItems.length);e.button.querySelector("span").innerHTML=t,e.button.querySelector("span").innerText=t}calculateMenuHeight(e){if(this.settings.size){let t=null;if(t=e.querySelector("li")){let e=this.settings.menuItemHeight??31;t.scrollHeight?e=t.scrollHeight:t.offsetHeight?e=t.offsetHeight:t.clientHeight&&(e=t.clientHeight),this.settings.menuHeight+=this.settings.size*e}e.querySelector(".ezmodus-menu ul").style.maxHeight=this.settings.menuHeight+2+"px"}}render(){let e=document.createElement("div");e.classList.add("ezmodus-select"),this.select.parentNode.insertBefore(e,this.select),e.appendChild(this.select),this.button=this.createDropdownButton(e,this.select),e.appendChild(this.button),e.appendChild(this.createMenu()),this.changeDropdownButton(),this.calculateMenuHeight(e),e.addEventListener("focusout",(function(t){t.currentTarget.contains(t.relatedTarget)||e.classList.remove("open-menu")})),this.dropdown=e}}document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("select.ezmodus-select-picker").forEach((t=>new e(t)))}))})();